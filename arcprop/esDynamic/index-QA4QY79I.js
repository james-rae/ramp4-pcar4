import{c_ as O,d1 as t,c$ as i,dO as F,dP as E,e1 as I,iF as Z,dT as L,ea as g,dX as M,d0 as v,d$ as d,ff as f,eb as w,dS as T,e0 as $,dY as H,dW as y,iD as S,dZ as N,gn as W,r as z,fh as P,e6 as R,iG as U,e7 as X,dU as Y,dV as j,e9 as b,F as J,dG as K}from"./main-riG7c9Vi.js";import{u as ee}from"./draw-store-DQzusLrv.js";const te={},ae={class:"border-b p-0 self-center w-2/3"};function oe(x,n){return t(),i("span",ae)}const D=O(te,[["render",oe]]),ne=F({__name:"zoom-nav",setup(x){const{t:n}=E(),a=I("iApi"),o=Z(400,!0,()=>a.geo.map.zoomIn()),r=Z(400,!0,()=>a.geo.map.zoomOut());return(e,c)=>{const s=L("mapnav-button");return t(),i("div",null,[g(s,{onClickFunction:d(o),tooltip:d(n)("mapnav.zoomIn")},{default:M(()=>c[0]||(c[0]=[v("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[v("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"}),v("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"]),g(D),g(s,{onClickFunction:d(r),tooltip:d(n)("mapnav.zoomOut")},{default:M(()=>c[1]||(c[1]=[v("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",class:"fill-current w-32 h-20"},[v("path",{d:"M19 13H5v-2h14v2z"}),v("path",{d:"M0 0h24v24H0z",fill:"none"})],-1)])),_:1},8,["onClickFunction","tooltip"])])}}}),ie={class:"mapnav-section bg-white-75 hover:bg-white"},se=F({__name:"draw-nav-section",setup(x){const n=I("iApi"),{t:a}=E(),o=ee(),r=[{type:"point",icon:f(w(()=>import("./point-icon-CgMYK2sl.js")))},{type:"polyline",icon:f(w(()=>import("./polyline-icon-CANORBb9.js")))},{type:"polygon",icon:f(w(()=>import("./polygon-icon-EPLpqsfK.js")))},{type:"circle",icon:f(w(()=>import("./circle-icon-C_6tb0Fx.js")))},{type:"rectangle",icon:f(w(()=>import("./rectangle-icon-DYiNWlZh.js")))}],e=T(()=>{const l=r.filter(u=>o.supportedTypes.some(_=>_.type===u.type));return l.push({type:"edit",icon:f(w(()=>import("./edit-icon-CXt5X-dW.js")))}),l}),c=l=>{o.activeTool===l?o.setActiveTool(null):o.setActiveTool(l)},s=()=>{n.geo.map.setMouseFocus()};return(l,u)=>{const _=L("mapnav-button");return t(),i("div",ie,[(t(!0),i($,null,H(e.value,(m,C)=>(t(),y(_,{key:m.type,onMousedown:s,onClickFunction:()=>c(m.type),tooltip:d(a)(`draw.${m.type}.tooltip`),class:N({"active-tool":d(o).activeTool===m.type}),style:W({marginBottom:C!==e.value.length-1?"0px":"0"})},{default:M(()=>[(t(),y(S(m.icon),{class:"fill-current w-32 h-20"}))]),_:2},1032,["onClickFunction","tooltip","class","style"]))),128))])}}}),G=O(se,[["__scopeId","data-v-13aefb77"]]),le={class:"mapnav absolute right-0 bottom-0 pb-36 sm:pb-48 pr-12"},re=["content"],ce={class:"mapnav-section bg-white-75 hover:bg-white"},pe={key:1,class:"mapnav-section bg-white-75 hover:bg-white"},ve=["content"],ue={key:0},me=F({__name:"mapnav",setup(x){const n=z(void 0),a=I("iApi"),o=P(),{t:r}=E(),e=z(),c=T(()=>a.getConfig().fixtures.mapnav.items.some(p=>p==="draw")),s=z(a.$rootEl?.clientHeight),l=z(!1),u=z(0),_=()=>{s.value=a.$rootEl?.clientHeight},m=()=>{e.value._tippy.hide()},C=p=>{p.key==="Tab"&&e.value?.matches(":focus")&&e.value._tippy.show()};R(()=>{e.value?.addEventListener("blur",m),e.value?.addEventListener("keyup",C),n.value=new ResizeObserver(_),n.value.observe(a.$rootEl),U(()=>{u.value=A.value.length*82})}),X(()=>{e.value?.removeEventListener("blur",m),e.value?.removeEventListener("keyup",C),n.value.disconnect()});const A=T(()=>o.order.map(p=>o.items[p]).filter(p=>p.componentId&&p.id!=="draw"));return(p,h)=>{const q=L("mapnav-button"),Q=Y("focus-list"),B=Y("tippy");return t(),i("div",le,[j((t(),i("div",{class:"mapnav-section flex flex-col",content:d(r)("panels.controls.items"),ref_key:"el",ref:e},[c.value&&s.value>u.value?(t(),i($,{key:0},[g(G),h[0]||(h[0]=v("span",{class:"py-1"},null,-1))],64)):b("",!0),g(ne,{class:"mapnav-section bg-white-75 hover:bg-white"}),h[2]||(h[2]=v("span",{class:"py-1"},null,-1)),v("div",ce,[s.value<=u.value?(t(),y(q,{key:0,class:"self-center",onClickFunction:()=>{l.value=!l.value},tooltip:l.value?p.$t("mapnav.closeMenu"):p.$t("mapnav.openMenu")},{default:M(()=>[(t(),i("svg",{xmlns:"http://www.w3.org/2000/svg","shape-rendering":"geometricPrecision","text-rendering":"geometricPrecision","image-rendering":"optimizeQuality","fill-rule":"evenodd","clip-rule":"evenodd",viewBox:"0 0 319 511.61",class:N(["fill-current w-6 mx-auto transition-all transform",{"rotate-180":l.value}])},h[1]||(h[1]=[v("path",{d:"m270.08 5.89 43.04 43.04c7.85 7.86 7.83 20.72 0 28.54L134.77 255.82l178.35 178.35c7.85 7.86 7.8 20.73 0 28.54l-43.04 43.04c-7.83 7.82-20.71 7.82-28.54 0L49.29 313.49l-.37-.36-43.04-43.04c-7.82-7.83-7.86-20.68 0-28.54l43.04-43.04.37-.36L241.54 5.89c7.85-7.85 20.68-7.85 28.54 0z"},null,-1)]),2))]),_:1},8,["onClickFunction","tooltip"])):b("",!0)]),s.value>u.value?(t(),i("div",pe,[(t(!0),i($,null,H(A.value,(k,V)=>(t(),i($,{key:k.id+"button"},[(t(),y(S(k.id+"-nav-button"))),V!==A.value.length-1?(t(),y(D,{key:0,class:"mapnav-divider"})):b("",!0)],64))),128))])):b("",!0)],8,re)),[[Q],[B,{trigger:"manual",placement:"top-end",touch:!1,maxWidth:190}]]),s.value<=u.value&&l.value?j((t(),i("div",{key:0,class:"mapnav-section flex flex-col flex-wrap-reverse shadow-tm absolute right-56 bottom-36 sm:bottom-48 items-start z-50 gap-0.5",style:W({maxHeight:`${(s.value-70)*.8}px`,height:"fit-content",width:"fit-content"}),content:d(r)("panels.controls.items")},[c.value?(t(),i("div",ue,[g(G)])):b("",!0),(t(!0),i($,null,H(A.value,(k,V)=>(t(),y(S(k.id+"-nav-button"),{key:k.id+"button",class:"mapnav-section bg-white-75 hover:bg-white",showOutline:""}))),128))],12,ve)),[[B,{trigger:"manual",placement:"top-end",maxWidth:190}]]):b("",!0)])}}}),de=O(me,[["__scopeId","data-v-2e9df1e2"]]);class he extends J{mapnavStore=P(this.$vApp.$pinia);get config(){return super.config}_parseConfig(n){if(!n)return;const a=n.items.map(o=>({id:o}));this.mapnavStore.items=a.reduce((o,r)=>(o[r.id]=r,o),{}),this.mapnavStore.order=a.map(o=>o.id),this._validateItems()}_validateItems(){const n=["geolocator","zoom","home","fullscreen"];this.mapnavStore.order.forEach(a=>{(this.$iApi.fixture.exists(a)||n.includes(a))&&(this.mapnavStore.items[a].componentId=`${a}-nav-button`)})}}const ge={en:{"mapnav.openMenu":"Open navigation","mapnav.closeMenu":"Close navigation","mapnav.zoomIn":"Zoom In","mapnav.zoomOut":"Zoom Out","mapnav.home":"Home","mapnav.fullscreen":"Full Screen","mapnav.geolocator":"Your Location","mapnav.geolocator.error.permission":"The location request was denied. Please check your browser permission settings.","mapnav.geolocator.error.internal":"Your location could not be found."},fr:{"mapnav.openMenu":"Ouvrir la navigation","mapnav.closeMenu":"Fermer la navigation","mapnav.zoomIn":"Zoom avant","mapnav.zoomOut":"Zoom arri\xE8re","mapnav.home":"Accueil","mapnav.fullscreen":"Plein \xC9cran","mapnav.geolocator":"Votre position","mapnav.geolocator.error.permission":"Demande de localisation refus\xE9e. Veuillez v\xE9rifier les param\xE8tres d'autorisation de votre navigateur.","mapnav.geolocator.error.internal":"Votre emplacement n'a pu \xEAtre trouv\xE9."}};class fe extends he{async added(){Object.entries(ge).forEach(e=>this.$iApi.$i18n.mergeLocaleMessage(...e));const{destroy:n,el:a}=this.mount(de,{app:this.$element});this.$vApp.$el.getElementsByClassName("inner-shell")[0].appendChild(a.childNodes[0]),this._parseConfig(this.config);const o=this.$vApp.$watch(()=>this.config,e=>this._parseConfig(e)),r=this.$iApi.event.on(K.COMPONENT,()=>{this._parseConfig(this.config)});this.removed=()=>{o(),this.$iApi.event.off(r);const e=P(this.$vApp.$pinia),c={...e.items};Object.keys(c).forEach(s=>e.removeItem(s)),e.$reset(),n()}}}export{fe as default};
