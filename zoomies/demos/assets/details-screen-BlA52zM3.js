import{fy as V,as as b,fR as re,eb as a,ec as t,ed as g,fU as B,fJ as Q,fI as Y,iJ as ge,fL as Z,fM as z,ea as ue,im as ee,fC as L,fK as A,fD as q,ir as he,fZ as ne,fz as K,lx as ce,fP as te,fQ as U,fT as se,fG as x,fE as J,fS as le,kS as _e,lC as me,jp as ie,m7 as Me,fX as X,fV as oe,fH as pe,fF as Ee}from"./main-DikCguZg.js";import{T as Ce}from"./toggle-switch-control-BmUQbO8q.js";import"./preload-helper-DMGCcr4D.js";const Se={key:0,class:"relative"},De={key:0,class:"relative"},He=["innerHTML"],je=["src"],ze={key:1,class:"w-32 h-32"},Be={class:"symbologyIcon"},Ne=["innerHTML"],Oe=["src"],qe={class:"badge z-50 rounded-full text-white absolute h-10 w-10 p-8 inline-flex items-center justify-center"},Ae={key:0,class:"px-5"},Fe={key:1,class:"inline-flex justify-center items-center relative"},Pe=V({__name:"symbology-stack",props:{layer:{type:Object,required:!0},result:{type:Object,required:!0}},setup(v){const I=v,s=b([]);return re(()=>{s.value=I.layer.legend}),(f,y)=>v.result.loaded?(t(),a("div",Se,[g("div",{class:Z(v.result.items.length===0?"opacity-50":"")},[s.value.length>1?(t(),a("div",De,[(t(!0),a(Q,null,Y(s.value.slice(0,3).reverse(),(h,m)=>(t(),a("div",{class:Z(["absolute",[m==0?"symbol-0":m==1?"left-3":"left-6"]]),style:ge({"z-index":3-m}),key:m},[s.value[m].svgcode?(t(),a("span",{key:0,class:"symbologyIcon w-28 h-28",innerHTML:s.value[m].svgcode},null,8,He)):s.value[m].imgUrl?(t(),a("img",{key:1,class:"symbologyIcon w-28 h-28",src:s.value[m].imgUrl},null,8,je)):B("",!0)],6))),128))])):s.value.length>0?(t(),a("div",ze,[g("div",Be,[s.value[0].svgcode?(t(),a("span",{key:0,innerHTML:s.value[0].svgcode},null,8,Ne)):s.value[0].imgUrl?(t(),a("img",{key:1,class:"symbologyIcon w-full h-full",src:s.value[0].imgUrl},null,8,Oe)):B("",!0)])])):B("",!0)],2),g("div",qe,[v.result.loaded?(t(),a("div",Ae,z(v.result.items.length),1)):B("",!0)])])):(t(),a("div",Fe,y[0]||(y[0]=[g("div",{class:"symbologyIcon h-32 w-32"},[g("div",{class:"relative animate-spin spinner h-24 w-24"})],-1)])))}}),Ve=ue(Pe,[["__scopeId","data-v-e0b0309a"]]),Ge=["content"],Re={class:"symbologyLayerName truncate"},Ue=V({__name:"symbology-item",props:{layer:{type:Object,required:!0},result:{type:Object,required:!0},selected:{type:Boolean,required:!0}},setup(v){const I=ee(),s=L(()=>I.properties),f=v,y=()=>{const h=f.layer;return h&&s.value[h.id]&&s.value[h.id].name?s.value[h.id].name:h?.name??""};return(h,m)=>{const S=A("tippy");return q((t(),a("button",{class:Z(["flex flex-grow justify-start items-center px-7 py-10 default-focus-style symbologyStackButton truncate",v.selected?"detailsButtonSelected":"px-11"]),onClick:m[0]||(m[0]=he(()=>{},["stop"])),content:y()},[ne(Ve,{class:"symbStack w-32 h-32 mr-10",layer:v.layer,result:v.result},null,8,["layer","result"]),g("div",Re,z(y()),1)],10,Ge)),[[S,{placement:"right",sticky:!0}]])}}}),Ze=["content"],Je=V({__name:"symbology-list",props:{results:{type:Object,required:!0},selected:{type:String,required:!0}},emits:["selection-changed"],setup(v,{emit:I}){const{t:s}=K(),f=ce(),y=b(),h=()=>{y.value._tippy.hide()},m=r=>{r.key==="Tab"&&y.value?.matches(":focus")&&y.value._tippy.show()},S=I,E=v,e=b(""),u=b([]),o=b(!1),i=b(!1),p=r=>f.getLayerByUid(r),c=r=>{e.value=r,S("selection-changed",r),o.value=!1},_=()=>{i.value||setTimeout(()=>{o.value=i.value},500),i.value=!0},N=()=>{o.value=i.value=!1},D=()=>{i.value||(o.value=!0),i.value=!0},H=()=>{o.value=i.value=!1};return te(()=>{u.value.push(U(E,()=>{e.value=E.selected}))}),re(()=>{y.value?.addEventListener("blur",h),y.value?.addEventListener("keyup",m)}),se(()=>{u.value.forEach(r=>r()),y.value?.removeEventListener("blur",h),y.value?.removeEventListener("keyup",m)}),(r,w)=>{const T=A("focus-item"),F=A("focus-list"),M=A("tippy");return q((t(),a("div",{class:Z(["symbology-list absolute overflow-hidden z-50 p-0 w-48 bg-white text-sm inline-flex flex-col",{"symbology-list-expanded":o.value}]),onMouseover:_,onMouseleave:N,onFocus:D,onBlur:he(H,["self"]),content:x(s)("details.layers.results.list.tooltip"),ref_key:"el",ref:y},[(t(!0),a(Q,null,Y(E.results,(O,l)=>(t(),a("div",{class:"flex justify-start relative",key:l},[q((t(),J(Ue,{key:O.uid,layer:p(O.uid),result:O,selected:O.uid===e.value,onClick:d=>c(O.uid)},null,8,["layer","result","selected","onClick"])),[[T]])]))),128))],42,Ze)),[[F],[M,{trigger:"manual",placement:"top-start",touch:!1}]])}}}),Ke={class:"inline font-bold"},Qe=["innerHTML"],We=V({__name:"esri-default",props:{fixtureFields:{type:Object,required:!1},fields:{type:Object,required:!0},identifyData:{type:Object,required:!0}},setup(v){const{t:I}=K(),s=le("iApi"),f=v,y=(e,u,o,i)=>{const p=e.find(c=>c[u].toLowerCase()===o.toLowerCase());p&&delete i[p.name]},h=()=>{const e=Object.assign({},f.identifyData.data);y(f.fields,"type","geometry",e),s.ui.exposeOids||y(f.fields,"type","oid",e),s.ui.exposeMeasurements||(y(f.fields,"name","shape_length",e),y(f.fields,"name","shape_area",e));const u={};f.fields.forEach(i=>{const p=f.fixtureFields?.find(c=>i.name===c.field);u[i.name]={name:p?.alias||i.alias||i.name,type:i.type,visible:p?.visible??!0}});const o={};Object.keys(e).forEach(i=>{const p=u[i];if(p&&p.visible){const c=e[i];o[i]={value:typeof c=="number"?s.ui.formatNumber(c):c,alias:p.name,type:p.type}}});for(const[i]of Object.entries(o))s.ui.isPlainText(o[i].value)&&(o[i].value=s.ui.escapeHtml(o[i].value));return o},m=(e,u,o)=>{switch(o){case"date":return E(e);default:return S(e,u)}},S=(e,u)=>{if(!e)return e;if(e.trim().match(/\.(jpeg|jpg|gif|png)$/)||e.trim().match(/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i))return`<img src="${e}" alt="${I("details.item.alert.defaultAltText",{alias:u})}" />`;const o="underline text-blue-700 break-all",i=document.createElement("div");return i.innerHTML=e.trim(),i.firstElementChild?.tagName=="A"?(i.firstElementChild.className=o,i.innerHTML):_e(e,{className:o,target:"_blank",validate:{url:c=>/^https?:\/\//.test(c)}})},E=e=>{const u=parseInt(e);return isNaN(u)?e:new Date(u).toISOString().split("T")[0]};return(e,u)=>(t(),a("div",null,[(t(!0),a(Q,null,Y(h(),(o,i,p)=>(t(),a("div",{class:"p-5 pl-3 flex justify-end flex-wrap even:bg-gray-300",key:p},[g("span",Ke,z(o.alias),1),u[0]||(u[0]=g("span",{class:"flex-auto"},null,-1)),g("span",{class:"inline ml-8",innerHTML:m(o.value,o.alias,o.type)},null,8,Qe)]))),128))]))}}),Xe=["innerHTML"],Ye={key:1},et=V({__name:"html-default",props:{identifyData:{type:Object,required:!0}},setup(v){const{t:I}=K();return(s,f)=>v.identifyData?(t(),a("div",{key:0,class:"whitespace-pre-wrap break-words h-full overflow-auto",innerHTML:v.identifyData.data.data??v.identifyData.data},null,8,Xe)):(t(),a("div",Ye,z(x(I)("details.layers.results.empty")),1))}}),tt={class:"relative flex flex-grow truncate"},st={key:0,class:"flex flex-grow items-center truncate"},lt={class:"flex p-8 items-center"},at=["innerHTML"],nt={key:1,class:"symbologyIcon p-6"},it=["content","innerHTML","tabindex"],ot={key:1,class:"flex p-6 flex-grow"},rt={key:2,class:"zoomButton text-center p-3"},ut=["content","aria-label"],ct={key:0,class:"m-auto animate-spin spinner h-20 w-20"},dt={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"green",class:"m-auto w-20 h-20"},vt={key:2,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"red",class:"m-auto w-20 h-20"},ft=["innerHTML"],ye=V({__name:"result-item",props:{uid:{type:String,required:!0},data:{type:Object,required:!0},open:{type:Boolean,required:!1},inList:{type:Boolean,required:!1}},setup(v){const I=ce(),s=v,f=le("iApi"),y=b([]),h=ee(),{t:m}=K(),S=b(!1),E=b(""),e=b("none"),u=b(),o=()=>I.getLayerByUid(s.uid),i=L(()=>h.properties),p=L(()=>h.defaultTemplates),c=L(()=>o()?.supportsFeatures??!1),_=L(()=>o()?.mapLayer??!1),N=L(()=>{const l=o();let d=l&&s.data.loaded?l.nameValue(s.data.data):f.$i18n.t("details.items.title");return f.ui.isPlainText(d)&&(d=f.ui.escapeHtml(d)),d}),D=l=>{if(typeof l=="string"){const d="underline text-blue-700 break-all",C=document.createElement("div");return C.innerHTML=l.trim(),C.firstElementChild?.tagName=="A"?(C.firstElementChild.className=d,C.innerHTML):_e(l,{className:d,target:"_blank",validate:{url:$=>/^https?:\/\//.test($)}})}return l},H=()=>{M("none"),s.data.loaded?r():s.data.load().then(()=>{r()})},r=()=>{if(E.value="",!(s.data&&s.data.loaded))return;const l=o();if(l===void 0){console.warn(`could not find layer for uid ${s.uid} during icon lookup`);return}if(l.supportsFeatures){const d=l.oidField;l.getIcon(s.data.data[d]).then(C=>{E.value=C})}},w=L(()=>{const l=o(),d=l&&i.value[l.id]&&i.value[l.id].template;if(d){if(typeof me(d)!="string")return d;ie(()=>f.notify.show(Me.WARNING,f.$i18n.t("details.template.notFound",{layer:d})))}return p.value&&p.value[s.data.format]?p.value[s.data.format]:c.value?We:et}),T=L(()=>c.value?o()?.fields||[]:[]),F=L(()=>{const l=o();if(l&&i.value[l.id]&&i.value[l.id].fields)return i.value[l.id].fields}),M=l=>{l==="zoomed"||l==="error"?setTimeout(()=>{e.value=l,u.value?._tippy.show(),setTimeout(()=>{u.value?._tippy.hide(),e.value="none"},3e3)},300):e.value=l},O=()=>{if(e.value!=="none")return;M("zooming");const l=o();if(l===void 0||!l.isLoaded){console.warn(`Could not find layer for uid ${s.uid} during zoom geometry lookup`),M("error");return}if(!s.data.loaded){console.warn("Details zoomToFeature call on item that is still loading. Should be impossible, alert the devs."),M("error");return}const d=s.data.data[l.oidField];l.zoomToFeature(d).then(C=>{C?(M("zoomed"),f.updateAlert(f.$i18n.t("details.item.alert.zoom"))):M("error")})};return te(()=>{y.value.push(U(s,()=>{H()},{deep:!1,immediate:!0}))}),se(()=>{y.value.forEach(l=>l())}),(l,d)=>{const C=A("truncate"),j=A("tippy");return t(),a(Q,null,[g("div",tt,[c.value?(t(),a("div",st,[g("div",lt,[v.data.loaded&&E.value?(t(),a("span",{key:0,class:"flex-none symbologyIcon",innerHTML:E.value},null,8,at)):(t(),a("div",nt,d[3]||(d[3]=[g("div",{class:"animate-spin spinner h-20 w-20"},null,-1)])))]),v.data.loaded?q((t(),a("span",{key:0,class:"pl-3 text-left flex-grow itemName",content:N.value,innerHTML:D(N.value),onTouchstart:d[0]||(d[0]=$=>S.value=!0),onTouchend:d[1]||(d[1]=$=>S.value=!1),tabindex:v.inList?-1:0},null,40,it)),[[C,{options:{placement:"top-start",offset:()=>S.value?[0,25]:[0,0]}}]]):(t(),a("div",ot,z(x(m)("details.loading")),1)),v.data.loaded?(t(),a("span",rt,[_.value?q((t(),a("button",{key:0,type:"button",content:x(m)(`details.item.zoom${e.value==="none"?"":`.${e.value}`}`),"aria-label":x(m)(`grid.cells.zoom${e.value==="none"?"":`.${e.value}`}`),ref_key:"zoomButton",ref:u,onClick:d[2]||(d[2]=$=>{$.stopPropagation(),O()}),class:"text-gray-600 w-24 h-24 p-2 flex justify-center items-center"},[e.value==="zooming"?(t(),a("div",ct)):e.value==="zoomed"?(t(),a("svg",dt,d[4]||(d[4]=[g("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"},null,-1)]))):e.value==="error"?(t(),a("svg",vt,d[5]||(d[5]=[g("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):(t(),a("span",{key:3,innerHTML:x(f).ui.getZoomIcon()},null,8,ft))],8,ut)),[[j,{placement:"bottom"}]]):B("",!0)])):B("",!0)])):B("",!0)]),v.open?(t(),J(me(w.value),{key:0,identifyData:v.data,fields:T.value,fixtureFields:F.value,class:"p-8"},null,8,["identifyData","fields","fixtureFields"])):B("",!0)],64)}}}),mt={key:0,class:"layerName w-full flex-grow p-5 pb-8 font-bold truncate",tabIndex:"0"},pt={key:1,class:"p-8 mb-8 bg-gray-100 flex justify-between"},yt={for:"toggle"},gt={key:2,class:"flex flex-col justify-between p-8 mb-8 bg-gray-100"},ht={class:"flex"},_t=["aria-label"],bt=["content","aria-label","disabled"],kt={class:"px-3 text-center flex-grow"},xt=["content","aria-label","disabled"],Lt={key:3},wt={key:0},$t=["content"],Tt=["onClick"],It={key:1,class:"text-center"},Mt={key:4,class:"p-5"},Et=V({__name:"result-list",props:{uid:{type:String,required:!0},results:{type:Object,required:!0}},emits:["item-selected"],setup(v,{emit:I}){const s=b(),f=()=>{s.value._tippy.hide()},y=n=>{n.key==="Tab"&&s.value?.matches(":focus")&&s.value._tippy.show()},h=le("iApi"),m=ee(),S=ce(),E=I,e=v,{t:u}=K(),o=b(!1),i=b(h.fixture.get("details")),p=b(!0),c=b(!1),_=b(0),N=b(20),D=b([]),H=b([]),r=L(()=>m.activeGreedy),w=L(()=>m.properties),T=L(()=>_.value+N.value),F=()=>S.getLayerByUid(e.uid),M=()=>e.results.find(n=>n.uid===e.uid),O=L(()=>M()?.loaded??!1),l=L(()=>M()?.requestTime),d=L(()=>o.value&&(!c.value&&$().length>1||c.value&&$().length>N.value)),C=L(()=>{const n=F();return n&&w.value[n.id]&&w.value[n.id].name?w.value[n.id].name:n?.name??""}),j=L(()=>e.uid),$=()=>{const n=M();return n?n.items:[]},G=L(()=>$()[_.value]),de=L(()=>{if(i.value.hasHilighter()){const n=F();if(n)return n.mapLayer&&n.supportsFeatures}return!1}),be=n=>{p.value=n,m.hilightToggle=n,P()},ke=()=>{const n=F();_.value=_.value??0,p.value=m.hilightToggle??p.value,c.value=!1,o.value=!!n,P()},ve=n=>{c.value?(_.value+=n*N.value,P()):_.value+=n},P=async(n=!1)=>{if(p.value&&de.value){if(n){const R=M();R&&await R.loading}const k=$();if(O.value&&k.length>0){if(c.value)i.value.hilightDetailsItems(k.slice(_.value,T.value),e.uid);else{const R=k[_.value];R&&i.value.hilightDetailsItems([R],e.uid)}return}}i.value.removeDetailsHilight()},xe=()=>{c.value=!0,_.value=Math.floor(_.value/N.value)*N.value,P()},Le=()=>{i.value.removeDetailsHilight(),H.value.forEach(n=>n()),D.value.forEach(n=>h.event.off(n))},we=()=>{i.value.removeDetailsHilight()},$e=n=>{const k=_.value;_.value=n,c.value=!1,k===n&&P(),E("item-selected")};return re(()=>{D.value.push(h.event.on(X.LAYER_REMOVE,n=>{const k=h.panel.get("details");e.uid===n.uid&&k&&k.close()})),D.value.push(h.event.on(X.PANEL_CLOSED,n=>{n.id==="details"&&Le()})),D.value.push(h.event.on(X.PANEL_MINIMIZED,n=>{n.id==="details"&&we()})),D.value.push(h.event.on(X.MAP_BASEMAPCHANGE,n=>{p.value&&n.schemaChanged&&P()})),s.value?.addEventListener("blur",f),s.value?.addEventListener("keyup",y)}),te(()=>{H.value.push(U(G,()=>{c.value||(ke(),G.value===void 0&&i.value.removeDetailsHilight())},{deep:!1,immediate:!0})),H.value.push(U(j,()=>{const n=e.uid;if(c.value&&n){const k=M();k&&k.loading.then(()=>{e.uid===n&&c.value&&P()})}},{deep:!1,immediate:!0})),H.value.push(U(l,()=>{_.value=0,c.value&&P(!0)})),H.value.push(U(()=>e.uid,()=>{_.value=0}))}),se(()=>{s.value?.removeEventListener("blur",f),s.value?.removeEventListener("keyup",y)}),(n,k)=>{const R=A("truncate"),ae=A("tippy"),Te=A("focus-item"),Ie=A("focus-list");return O.value&&r.value===0?(t(),a("div",{key:0,class:"detailsContent relative flex flex-col flex-grow pl-5",style:ge(v.results.length>1?{"margin-left":"42px"}:"")},[o.value?q((t(),a("h1",mt,[oe(z(C.value),1)])),[[R,{options:{placement:"top-start"}}]]):B("",!0),de.value?(t(),a("div",pt,[g("label",yt,z(x(u)("details.togglehilight.title")),1),ne(Ce,{config:{value:p.value,disabled:!1},onToggled:be},null,8,["config"])])):B("",!0),d.value?(t(),a("div",gt,[g("div",ht,[c.value?B("",!0):(t(),a("button",{key:0,type:"button",class:"px-8 font-bold hover:bg-gray-200 focus:bg-gray-200","aria-label":x(u)("details.item.see.list"),onClick:k[0]||(k[0]=W=>xe())},z(x(u)("details.item.see.list")),9,_t)),g("div",{class:Z(["flex ml-auto bg-gray-200 py-8 items-center",{"w-full":c.value}])},[q((t(),a("button",{type:"button",content:x(u)(c.value?"details.items.previous":"details.item.previous.item"),onClick:k[1]||(k[1]=W=>ve(-1)),class:"mx-2 opacity-60 hover:opacity-90 disabled:opacity-30 disabled:cursor-default","aria-label":x(u)(c.value?"details.items.previous":"details.item.previous.item"),disabled:_.value===0},k[3]||(k[3]=[g("svg",{height:"24",width:"24",viewBox:"0 0 23 23"},[g("g",null,[g("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})])],-1)]),8,bt)),[[ae,{placement:"top"}]]),g("span",kt,z(c.value?x(u)("details.items.range",[_.value+1,Math.min(T.value,$().length),$().length]):x(u)("details.item.count",[_.value+1,$().length])),1),q((t(),a("button",{type:"button",content:x(u)(c.value?"details.items.next":"details.item.next.item"),onClick:k[2]||(k[2]=W=>ve(1)),class:"mx-2 rotate-180 opacity-60 hover:opacity-90 disabled:opacity-30 disabled:cursor-default","aria-label":x(u)(c.value?"details.items.next":"details.item.next.item"),disabled:!c.value&&_.value===$().length-1||c.value&&T.value>=$().length},k[4]||(k[4]=[g("svg",{height:"24",width:"24",viewBox:"0 0 23 23"},[g("g",null,[g("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})])],-1)]),8,xt)),[[ae,{placement:"top"}]])],2)])])):B("",!0),o.value?(t(),a("div",Lt,[$().length>0?(t(),a("div",wt,[c.value?q((t(),a("div",{key:0,class:"flex flex-col",content:x(u)("details.layers.results.list.tooltip"),ref_key:"el",ref:s},[(t(!0),a(Q,null,Y($().slice(_.value,T.value),(W,fe)=>q((t(),a("button",{class:"flex flex-grow truncate default-focus-style hover:bg-gray-200",key:fe,onClick:Ht=>$e(_.value+fe)},[ne(ye,{data:W,uid:v.uid,open:!1,"in-list":!0},null,8,["data","uid"])],8,Tt)),[[Te,"show-truncate"]])),128))],8,$t)),[[Ie],[ae,{trigger:"manual",placement:"top-start",touch:!1}]]):(t(),J(ye,{key:1,data:G.value,uid:v.uid,open:!0,"in-list":!1},null,8,["data","uid"]))])):(t(),a("div",It,z(x(u)("details.layers.results.empty.currentLayer")),1))])):(t(),a("div",Mt,z(x(u)("details.item.no.data")),1))],4)):(t(),a("div",{key:1,class:Z(["flex justify-center py-10 items-center",v.results.length>1?"ml-42":""])},[k[5]||(k[5]=g("span",{class:"animate-spin spinner h-20 w-20 px-5 mr-8"},null,-1)),oe(" "+z(x(u)("details.item.loading")),1)],2))}}}),Ct=ue(Et,[["__scopeId","data-v-4538155c"]]),St={class:"relative h-full"},Dt=V({__name:"details-screen",props:{panel:{type:Object}},setup(v){const{t:I}=K(),s=le("iApi"),f=ee(),y=b([]),h=b([]),m=b([]),S=b(!1),E=b(null),e=b(""),u=L(()=>f.activeGreedy),o=L(()=>f.payload),i=L(()=>f.properties),p=r=>{e.value=r},c=r=>m.value.find(w=>w.uid===r),_=r=>{r!==void 0&&(f.activeGreedy=r.length===0?0:r[0].requestTime,m.value=r,N(r))},N=r=>{if(e.value){const w=c(e.value);w?w.loading.then(()=>{w.requestTime===u.value&&(w.items.length>0?H(!1):D(r))}):D(r)}else D(r)},D=(r,w)=>{let T;if(w)T=w;else{const l=f.properties,d=r.map(j=>[l[j.layerId]?.priority??50,j.layerId]),C=new Set(d.map(j=>j[0]));T=[],C.forEach(j=>{const $=d.filter(G=>G[0]===j).map(G=>G[1]);T.push([j,$])}),T.sort((j,$)=>$[0]-j[0])}if(T.length===0){o.value.length?H(!0):ie().then(()=>{H(!0)});return}const F=T[T.length-1][1],M=r.filter(l=>F.includes(l.layerId)).map(l=>l.loading.then(()=>l.items.length>0?Promise.resolve(l):Promise.reject())),O=r.length===0?0:r[0].requestTime;Promise.any(M).then(l=>{l.requestTime===u.value&&(e.value=l.uid,H(!1))}).catch(()=>{O===u.value&&(T.pop(),D(r,T))})},H=r=>{f.activeGreedy=0,S.value=r};return te(()=>{h.value.push(U(o,r=>{_(r)},{deep:!1,immediate:!0}))}),se(()=>{y.value.forEach(r=>s.event.off(r)),h.value.forEach(r=>r())}),(r,w)=>{const T=Ee("panel-screen");return t(),J(T,{panel:v.panel},{header:pe(()=>[oe(z(x(f).origin==="toggleEvent"?x(I)("details.layers.title.gridOrigin"):x(I)("details.layers.title.identifyOrigin")),1)]),content:pe(()=>[g("div",St,[m.value.length>1?(t(),J(Je,{key:0,results:m.value,detailsProperties:i.value,selected:e.value,onSelectionChanged:p},null,8,["results","detailsProperties","selected"])):B("",!0),g("div",{class:"detailsContentSection overflow-y-auto h-full",ref_key:"detailsPanel",ref:E},[S.value?(t(),a("div",{key:1,class:Z(["text-center",{"ml-42":m.value.length>1}])},z(m.value.length>=1?x(I)("details.layers.results.empty"):x(I)("details.layers.results.empty.noLayers")),3)):(t(),J(Ct,{key:0,uid:e.value,results:m.value,onItemSelected:w[0]||(w[0]=()=>ie(()=>E.value?.scrollTo({top:0})))},null,8,["uid","results"]))],512)])]),_:1},8,["panel"])}}}),Nt=ue(Dt,[["__scopeId","data-v-1d94dd9a"]]);export{Nt as default};
