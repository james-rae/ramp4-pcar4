import{fy as G,ar as x,fR as ie,e8 as s,e9 as t,ea as g,fU as O,fJ as J,fI as Y,iG as ye,fL as Q,fM as N,e7 as ne,ij as X,fC as L,fK as B,fD as F,iq as me,fW as ue,fz as W,lt as re,fP as ee,fQ as V,fT as te,fG as w,fE as Z,fS as le,kP as fe,ly as ge,jm as oe,m3 as Ie,fq as ae,fV as de,fH as he,fF as He}from"./main-BWKyCm7Q.js";import{T as je}from"./toggle-switch-control-CNL-_u5C.js";const Ce={key:0,class:"relative"},De={key:0,class:"relative"},ze=["innerHTML"],qe=["src"],Ne={key:1,class:"w-32 h-32"},Oe={class:"symbologyIcon"},Se=["innerHTML"],$e=["src"],Be={class:"badge z-50 rounded-full text-white absolute h-10 w-10 p-8 inline-flex items-center justify-center"},Fe={key:0,class:"px-5"},Ae={key:1,class:"inline-flex justify-center items-center relative"},Pe=G({__name:"symbology-stack",props:{layer:{type:Object,required:!0},result:{type:Object,required:!0}},setup(v){const M=v,l=x([]);return ie(()=>{l.value=M.layer.legend}),(p,f)=>v.result.loaded?(t(),s("div",Ce,[g("div",{class:Q(v.result.items.length===0?"opacity-50":"")},[l.value.length>1?(t(),s("div",De,[(t(!0),s(J,null,Y(l.value.slice(0,3).reverse(),(h,y)=>(t(),s("div",{class:Q(["absolute",[y==0?"symbol-0":y==1?"left-3":"left-6"]]),style:ye({"z-index":3-y}),key:y},[l.value[y].svgcode?(t(),s("span",{key:0,class:"symbologyIcon w-28 h-28",innerHTML:l.value[y].svgcode},null,8,ze)):l.value[y].imgUrl?(t(),s("img",{key:1,class:"symbologyIcon w-28 h-28",src:l.value[y].imgUrl},null,8,qe)):O("",!0)],6))),128))])):l.value.length>0?(t(),s("div",Ne,[g("div",Oe,[l.value[0].svgcode?(t(),s("span",{key:0,innerHTML:l.value[0].svgcode},null,8,Se)):l.value[0].imgUrl?(t(),s("img",{key:1,class:"symbologyIcon w-full h-full",src:l.value[0].imgUrl},null,8,$e)):O("",!0)])])):O("",!0)],2),g("div",Be,[v.result.loaded?(t(),s("div",Fe,N(v.result.items.length),1)):O("",!0)])])):(t(),s("div",Ae,f[0]||(f[0]=[g("div",{class:"symbologyIcon h-32 w-32"},[g("div",{class:"relative animate-spin spinner h-24 w-24"})],-1)])))}}),Ge=ne(Pe,[["__scopeId","data-v-496d788d"]]),Ue=["content"],Re={class:"symbologyLayerName truncate"},Qe=G({__name:"symbology-item",props:{layer:{type:Object,required:!0},result:{type:Object,required:!0},selected:{type:Boolean,required:!0}},setup(v){const M=X(),l=L(()=>M.properties),p=v,f=()=>{const h=p.layer;return h&&l.value[h.id]&&l.value[h.id].name?l.value[h.id].name:h?.name??""};return(h,y)=>{const C=B("tippy");return F((t(),s("button",{class:Q(["flex flex-grow justify-start items-center px-7 py-10 default-focus-style symbologyStackButton truncate",v.selected?"detailsButtonSelected":"px-11"]),onClick:y[0]||(y[0]=me(()=>{},["stop"])),content:f()},[ue(Ge,{class:"symbStack w-32 h-32 mr-10",layer:v.layer,result:v.result},null,8,["layer","result"]),g("div",Re,N(f()),1)],10,Ue)),[[C,{placement:"right",sticky:!0}]])}}}),Ve=["content"],We=G({__name:"symbology-list",props:{results:{type:Object,required:!0},selected:{type:String,required:!0}},emits:["selection-changed"],setup(v,{emit:M}){const{t:l}=W(),p=re(),f=x(),h=()=>{f.value._tippy.hide()},y=u=>{u.key==="Tab"&&f.value?.matches(":focus")&&f.value._tippy.show()},C=M,H=v,e=x(""),o=x([]),r=x(!1),i=x(!1),m=u=>p.getLayerByUid(u),d=u=>{e.value=u,C("selection-changed",u),r.value=!1},b=()=>{i.value||setTimeout(()=>{r.value=i.value},500),i.value=!0},S=()=>{r.value=i.value=!1},D=()=>{i.value||(r.value=!0),i.value=!0},z=()=>{r.value=i.value=!1};return ee(()=>{o.value.push(V(H,()=>{e.value=H.selected}))}),ie(()=>{f.value?.addEventListener("blur",h),f.value?.addEventListener("keyup",y)}),te(()=>{o.value.forEach(u=>u()),f.value?.removeEventListener("blur",h),f.value?.removeEventListener("keyup",y)}),(u,_)=>{const T=B("focus-item"),A=B("focus-list"),I=B("tippy");return F((t(),s("div",{class:Q(["symbology-list absolute overflow-hidden z-50 p-0 w-48 bg-white text-sm inline-flex flex-col",{"symbology-list-expanded":r.value}]),onMouseover:b,onMouseleave:S,onFocus:D,onBlur:me(z,["self"]),content:w(l)("details.layers.results.list.tooltip"),ref_key:"el",ref:f},[(t(!0),s(J,null,Y(H.results,($,a)=>(t(),s("div",{class:"flex justify-start relative",key:a},[F((t(),Z(Qe,{key:$.uid,layer:m($.uid),result:$,selected:$.uid===e.value,onClick:c=>d($.uid)},null,8,["layer","result","selected","onClick"])),[[T]])]))),128))],42,Ve)),[[A],[I,{trigger:"manual",placement:"top-start",touch:!1}]])}}}),Ze={class:"inline font-bold"},Je=["innerHTML"],Ke=G({__name:"esri-default",props:{fixtureFields:{type:Object,required:!1},fields:{type:Object,required:!0},identifyData:{type:Object,required:!0}},setup(v){const{t:M}=W(),l=le("iApi"),p=v,f=(e,o,r,i)=>{const m=e.find(d=>d[o].toLowerCase()===r.toLowerCase());m&&delete i[m.name]},h=()=>{const e=Object.assign({},p.identifyData.data);f(p.fields,"type","geometry",e),l.ui.exposeOids||f(p.fields,"type","oid",e),l.ui.exposeMeasurements||(f(p.fields,"name","shape_length",e),f(p.fields,"name","shape_area",e));const o={};p.fields.forEach(i=>{const m=p.fixtureFields?.find(d=>i.name===d.field);o[i.name]={name:m?.alias||i.alias||i.name,type:i.type,visible:m?.visible??!0}});const r={};Object.keys(e).forEach(i=>{const m=o[i];if(m&&m.visible){const d=e[i];r[i]={value:typeof d=="number"?l.ui.formatNumber(d):d,alias:m.name,type:m.type}}});for(const[i]of Object.entries(r))l.ui.isPlainText(r[i].value)&&(r[i].value=l.ui.escapeHtml(r[i].value));return r},y=(e,o,r)=>{switch(r){case"date":return H(e);default:return C(e,o)}},C=(e,o)=>{if(!e)return e;if(e.trim().match(/\.(jpeg|jpg|gif|png)$/)||e.trim().match(/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i))return`<img src="${e}" alt="${M("details.item.alert.defaultAltText",{alias:o})}" />`;const r="underline text-blue-700 break-all",i=document.createElement("div");return i.innerHTML=e.trim(),i.firstElementChild?.tagName=="A"?(i.firstElementChild.className=r,i.innerHTML):fe(e,{className:r,target:"_blank",validate:{url:m=>/^https?:\/\//.test(m)}})},H=e=>{const o=parseInt(e);return isNaN(o)?e:new Date(o).toISOString().split("T")[0]};return(e,o)=>(t(),s("div",null,[(t(!0),s(J,null,Y(h(),(r,i,m)=>(t(),s("div",{class:"p-5 pl-3 flex justify-end flex-wrap even:bg-gray-300",key:m},[g("span",Ze,N(r.alias),1),o[0]||(o[0]=g("span",{class:"flex-auto"},null,-1)),g("span",{class:"inline ml-8",innerHTML:y(r.value,r.alias,r.type)},null,8,Je)]))),128))]))}}),Ye=["innerHTML"],Xe={key:1},et=G({__name:"html-default",props:{identifyData:{type:Object,required:!0}},setup(v){const{t:M}=W();return(l,p)=>v.identifyData?(t(),s("div",{key:0,class:"whitespace-pre-wrap break-words h-full overflow-auto",innerHTML:v.identifyData.data.data??v.identifyData.data},null,8,Ye)):(t(),s("div",Xe,N(w(M)("details.layers.results.empty")),1))}}),tt={class:"relative flex flex-grow truncate"},lt={key:0,class:"flex flex-grow items-center truncate"},at={class:"flex p-8 items-center"},st=["innerHTML"],it={key:1,class:"symbologyIcon p-6"},nt=["content","innerHTML","tabindex"],ut={key:1,class:"flex p-6 flex-grow"},rt={key:2,class:"zoomButton text-center p-3"},ot=["content","aria-label"],dt={key:0,class:"m-auto animate-spin spinner h-20 w-20"},ct={key:1,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"green",class:"m-auto w-20 h-20"},vt={key:2,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"red",class:"m-auto w-20 h-20"},pt=["innerHTML"],be=G({__name:"result-item",props:{uid:{type:String,required:!0},data:{type:Object,required:!0},open:{type:Boolean,required:!1},inList:{type:Boolean,required:!1}},setup(v){const M=re(),l=v,p=le("iApi"),f=x([]),h=X(),{t:y}=W(),C=x(!1),H=x(""),e=x("none"),o=x(),r=()=>M.getLayerByUid(l.uid),i=L(()=>h.properties),m=L(()=>h.defaultTemplates),d=L(()=>r()?.supportsFeatures??!1),b=L(()=>r()?.mapLayer??!1),S=L(()=>{const a=r();let c=a&&l.data.loaded?a.nameValue(l.data.data):p.$i18n.t("details.items.title");return p.ui.isPlainText(c)&&(c=p.ui.escapeHtml(c)),c}),D=a=>{if(typeof a=="string"){const c="underline text-blue-700 break-all",q=document.createElement("div");return q.innerHTML=a.trim(),q.firstElementChild?.tagName=="A"?(q.firstElementChild.className=c,q.innerHTML):fe(a,{className:c,target:"_blank",validate:{url:j=>/^https?:\/\//.test(j)}})}return a},z=()=>{I("none"),l.data.loaded?u():l.data.load().then(()=>{u()})},u=()=>{if(H.value="",!(l.data&&l.data.loaded))return;const a=r();if(a===void 0){console.warn(`could not find layer for uid ${l.uid} during icon lookup`);return}if(a.supportsFeatures){const c=a.oidField;a.getIcon(l.data.data[c]).then(q=>{H.value=q})}},_=L(()=>{const a=r(),c=a&&i.value[a.id]&&i.value[a.id].template;if(c){if(typeof ge(c)!="string")return c;oe(()=>p.notify.show(Ie.WARNING,p.$i18n.t("details.template.notFound",{layer:c})))}return m.value&&m.value[l.data.format]?m.value[l.data.format]:d.value?Ke:et}),T=L(()=>d.value?r()?.fields||[]:[]),A=L(()=>{const a=r();if(a&&i.value[a.id]&&i.value[a.id].fields)return i.value[a.id].fields}),I=a=>{a==="zoomed"||a==="error"?setTimeout(()=>{e.value=a,o.value?._tippy.show(),setTimeout(()=>{o.value?._tippy.hide(),e.value="none"},3e3)},300):e.value=a},$=()=>{if(e.value!=="none")return;I("zooming");const a=r();if(a===void 0||!a.isLoaded){console.warn(`Could not find layer for uid ${l.uid} during zoom geometry lookup`),I("error");return}if(!l.data.loaded){console.warn("Details zoomToFeature call on item that is still loading. Should be impossible, alert the devs."),I("error");return}const c=l.data.data[a.oidField];a.zoomToFeature(c).then(q=>{q?(I("zoomed"),p.updateAlert(p.$i18n.t("details.item.alert.zoom"))):I("error")})};return ee(()=>{f.value.push(V(l,()=>{z()},{deep:!1,immediate:!0}))}),te(()=>{f.value.forEach(a=>a())}),(a,c)=>{const q=B("truncate"),j=B("tippy");return t(),s(J,null,[g("div",tt,[d.value?(t(),s("div",lt,[g("div",at,[v.data.loaded&&H.value?(t(),s("span",{key:0,class:"flex-none symbologyIcon",innerHTML:H.value},null,8,st)):(t(),s("div",it,c[3]||(c[3]=[g("div",{class:"animate-spin spinner h-20 w-20"},null,-1)])))]),v.data.loaded?F((t(),s("span",{key:0,class:"pl-3 text-left flex-grow itemName",content:S.value,innerHTML:D(S.value),onTouchstart:c[0]||(c[0]=E=>C.value=!0),onTouchend:c[1]||(c[1]=E=>C.value=!1),tabindex:v.inList?-1:0},null,40,nt)),[[q,{options:{placement:"top-start",offset:()=>C.value?[0,25]:[0,0]}}]]):(t(),s("div",ut,N(w(y)("details.loading")),1)),v.data.loaded?(t(),s("span",rt,[b.value?F((t(),s("button",{key:0,type:"button",content:w(y)(`details.item.zoom${e.value==="none"?"":`.${e.value}`}`),"aria-label":w(y)(`grid.cells.zoom${e.value==="none"?"":`.${e.value}`}`),ref_key:"zoomButton",ref:o,onClick:c[2]||(c[2]=E=>{E.stopPropagation(),$()}),class:"text-gray-600 w-24 h-24 p-2 flex justify-center items-center"},[e.value==="zooming"?(t(),s("div",dt)):e.value==="zoomed"?(t(),s("svg",ct,c[4]||(c[4]=[g("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4.5 12.75l6 6 9-13.5"},null,-1)]))):e.value==="error"?(t(),s("svg",vt,c[5]||(c[5]=[g("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"},null,-1)]))):(t(),s("span",{key:3,innerHTML:w(p).ui.getZoomIcon()},null,8,pt))],8,ot)),[[j,{placement:"bottom"}]]):O("",!0)])):O("",!0)])):O("",!0)]),v.open?(t(),Z(ge(_.value),{key:0,identifyData:v.data,fields:T.value,fixtureFields:A.value,class:"p-8"},null,8,["identifyData","fields","fixtureFields"])):O("",!0)],64)}}}),yt={key:0,class:"layerName w-full flex-grow p-5 pb-8 font-bold truncate",tabIndex:"0"},mt={key:1,class:"p-8 mb-8 bg-gray-100 flex justify-between"},ft={for:"toggle"},gt={key:2,class:"flex flex-col justify-between p-8 mb-8 bg-gray-100"},ht={class:"flex"},bt=["aria-label"],xt=["content","aria-label","disabled"],kt={class:"px-3 text-center flex-grow"},wt=["content","aria-label","disabled"],Lt={key:3},Tt={key:0},_t=["content"],Et=["onClick"],Mt={key:1,class:"text-center"},It={key:4,class:"p-5"},Ht=G({__name:"result-list",props:{uid:{type:String,required:!0},results:{type:Object,required:!0}},emits:["item-selected"],setup(v,{emit:M}){const l=x(),p=()=>{l.value._tippy.hide()},f=n=>{n.key==="Tab"&&l.value?.matches(":focus")&&l.value._tippy.show()},h=le("iApi"),y=X(),C=re(),H=M,e=v,{t:o}=W(),r=x(!1),i=x(h.fixture.get("details")),m=x(!0),d=x(!1),b=x(0),S=x(20),D=x([]),z=x([]),u=L(()=>y.activeGreedy),_=L(()=>y.properties),T=L(()=>b.value+S.value),A=()=>C.getLayerByUid(e.uid),I=()=>e.results.find(n=>n.uid===e.uid),$=L(()=>I()?.loaded??!1),a=L(()=>I()?.requestTime),c=L(()=>r.value&&(!d.value&&E().length>1||d.value&&E().length>S.value)),q=L(()=>{const n=A();return n&&_.value[n.id]&&_.value[n.id].name?_.value[n.id].name:n?.name??""}),j=L(()=>e.uid),E=()=>{const n=I();return n?n.items:[]},U=L(()=>E()[b.value]),ce=L(()=>{if(i.value.hasHilighter()){const n=A();if(n)return n.mapLayer&&n.supportsFeatures}return!1}),xe=n=>{m.value=n,y.hilightToggle=n,P()},ke=()=>{const n=A();b.value=b.value??0,m.value=y.hilightToggle??m.value,d.value=!1,r.value=!!n,P()},ve=n=>{d.value?(b.value+=n*S.value,P()):b.value+=n},P=async(n=!1)=>{if(m.value&&ce.value){if(n){const R=I();R&&await R.loading}const k=E();if($.value&&k.length>0){if(d.value)i.value.hilightDetailsItems(k.slice(b.value,T.value),e.uid);else{const R=k[b.value];R&&i.value.hilightDetailsItems([R],e.uid)}return}}i.value.removeDetailsHilight()},we=()=>{d.value=!0,b.value=Math.floor(b.value/S.value)*S.value,P()},Le=()=>{i.value.removeDetailsHilight(),z.value.forEach(n=>n()),D.value.forEach(n=>h.event.off(n))},Te=()=>{i.value.removeDetailsHilight()},_e=n=>{const k=b.value;b.value=n,d.value=!1,k===n&&P(),H("item-selected")};return ie(()=>{D.value.push(h.event.on(ae.LAYER_REMOVE,n=>{const k=h.panel.get("details");e.uid===n.uid&&k&&k.close()})),D.value.push(h.event.on(ae.PANEL_CLOSED,n=>{n.id==="details"&&Le()})),D.value.push(h.event.on(ae.PANEL_MINIMIZED,n=>{n.id==="details"&&Te()})),D.value.push(h.event.on(ae.MAP_BASEMAPCHANGE,n=>{m.value&&n.schemaChanged&&P()})),l.value?.addEventListener("blur",p),l.value?.addEventListener("keyup",f)}),ee(()=>{z.value.push(V(U,()=>{d.value||(ke(),U.value===void 0&&i.value.removeDetailsHilight())},{deep:!1,immediate:!0})),z.value.push(V(j,()=>{const n=e.uid;if(d.value&&n){const k=I();k&&k.loading.then(()=>{e.uid===n&&d.value&&P()})}},{deep:!1,immediate:!0})),z.value.push(V(a,()=>{b.value=0,d.value&&P(!0)})),z.value.push(V(()=>e.uid,()=>{b.value=0}))}),te(()=>{l.value?.removeEventListener("blur",p),l.value?.removeEventListener("keyup",f)}),(n,k)=>{const R=B("truncate"),se=B("tippy"),Ee=B("focus-item"),Me=B("focus-list");return $.value&&u.value===0?(t(),s("div",{key:0,class:"detailsContent relative flex flex-col flex-grow pl-5",style:ye(v.results.length>1?{"margin-left":"42px"}:"")},[r.value?F((t(),s("h1",yt,[de(N(q.value),1)])),[[R,{options:{placement:"top-start"}}]]):O("",!0),ce.value?(t(),s("div",mt,[g("label",ft,N(w(o)("details.togglehilight.title")),1),ue(je,{config:{value:m.value,disabled:!1},onToggled:xe},null,8,["config"])])):O("",!0),c.value?(t(),s("div",gt,[g("div",ht,[d.value?O("",!0):(t(),s("button",{key:0,type:"button",class:"px-8 font-bold hover:bg-gray-200 focus:bg-gray-200","aria-label":w(o)("details.item.see.list"),onClick:k[0]||(k[0]=K=>we())},N(w(o)("details.item.see.list")),9,bt)),g("div",{class:Q(["flex ml-auto bg-gray-200 py-8 items-center",{"w-full":d.value}])},[F((t(),s("button",{type:"button",content:w(o)(d.value?"details.items.previous":"details.item.previous.item"),onClick:k[1]||(k[1]=K=>ve(-1)),class:"mx-2 opacity-60 hover:opacity-90 disabled:opacity-30 disabled:cursor-default","aria-label":w(o)(d.value?"details.items.previous":"details.item.previous.item"),disabled:b.value===0},k[3]||(k[3]=[g("svg",{height:"24",width:"24",viewBox:"0 0 23 23"},[g("g",null,[g("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})])],-1)]),8,xt)),[[se,{placement:"top"}]]),g("span",kt,N(d.value?w(o)("details.items.range",[b.value+1,Math.min(T.value,E().length),E().length]):w(o)("details.item.count",[b.value+1,E().length])),1),F((t(),s("button",{type:"button",content:w(o)(d.value?"details.items.next":"details.item.next.item"),onClick:k[2]||(k[2]=K=>ve(1)),class:"mx-2 rotate-180 opacity-60 hover:opacity-90 disabled:opacity-30 disabled:cursor-default","aria-label":w(o)(d.value?"details.items.next":"details.item.next.item"),disabled:!d.value&&b.value===E().length-1||d.value&&T.value>=E().length},k[4]||(k[4]=[g("svg",{height:"24",width:"24",viewBox:"0 0 23 23"},[g("g",null,[g("path",{d:"M15.41 16.09l-4.58-4.59 4.58-4.59L14 5.5l-6 6 6 6z"})])],-1)]),8,wt)),[[se,{placement:"top"}]])],2)])])):O("",!0),r.value?(t(),s("div",Lt,[E().length>0?(t(),s("div",Tt,[d.value?F((t(),s("div",{key:0,class:"flex flex-col",content:w(o)("details.layers.results.list.tooltip"),ref_key:"el",ref:l},[(t(!0),s(J,null,Y(E().slice(b.value,T.value),(K,pe)=>F((t(),s("button",{class:"flex flex-grow truncate default-focus-style hover:bg-gray-200",key:pe,onClick:qt=>_e(b.value+pe)},[ue(be,{data:K,uid:v.uid,open:!1,"in-list":!0},null,8,["data","uid"])],8,Et)),[[Ee,"show-truncate"]])),128))],8,_t)),[[Me],[se,{trigger:"manual",placement:"top-start",touch:!1}]]):(t(),Z(be,{key:1,data:U.value,uid:v.uid,open:!0,"in-list":!1},null,8,["data","uid"]))])):(t(),s("div",Mt,N(w(o)("details.layers.results.empty.currentLayer")),1))])):(t(),s("div",It,N(w(o)("details.item.no.data")),1))],4)):(t(),s("div",{key:1,class:Q(["flex justify-center py-10 items-center",v.results.length>1?"ml-42":""])},[k[5]||(k[5]=g("span",{class:"animate-spin spinner h-20 w-20 px-5 mr-8"},null,-1)),de(" "+N(w(o)("details.item.loading")),1)],2))}}}),jt=ne(Ht,[["__scopeId","data-v-60b1b8a2"]]),Ct={class:"relative h-full"},Dt=G({__name:"details-screen",props:{panel:{type:Object}},setup(v){const{t:M}=W(),l=le("iApi"),p=X(),f=x([]),h=x([]),y=x([]),C=x(!1),H=x(null),e=x(""),o=L(()=>p.activeGreedy),r=L(()=>p.payload),i=L(()=>p.properties),m=u=>{e.value=u},d=u=>y.value.find(_=>_.uid===u),b=u=>{u!==void 0&&(p.activeGreedy=u.length===0?0:u[0].requestTime,y.value=u,S(u))},S=u=>{if(e.value){const _=d(e.value);_?_.loading.then(()=>{_.requestTime===o.value&&(_.items.length>0?z(!1):D(u))}):D(u)}else D(u)},D=(u,_)=>{let T;if(_)T=_;else{const a=p.properties,c=u.map(j=>[a[j.layerId]?.priority??50,j.layerId]),q=new Set(c.map(j=>j[0]));T=[],q.forEach(j=>{const E=c.filter(U=>U[0]===j).map(U=>U[1]);T.push([j,E])}),T.sort((j,E)=>E[0]-j[0])}if(T.length===0){r.value.length?z(!0):oe().then(()=>{z(!0)});return}const A=T[T.length-1][1],I=u.filter(a=>A.includes(a.layerId)).map(a=>a.loading.then(()=>a.items.length>0?Promise.resolve(a):Promise.reject())),$=u.length===0?0:u[0].requestTime;Promise.any(I).then(a=>{a.requestTime===o.value&&(e.value=a.uid,z(!1))}).catch(()=>{$===o.value&&(T.pop(),D(u,T))})},z=u=>{p.activeGreedy=0,C.value=u};return ee(()=>{h.value.push(V(r,u=>{b(u)},{deep:!1,immediate:!0}))}),te(()=>{f.value.forEach(u=>l.event.off(u)),h.value.forEach(u=>u())}),(u,_)=>{const T=He("panel-screen");return t(),Z(T,{panel:v.panel},{header:he(()=>[de(N(w(p).origin==="toggleEvent"?w(M)("details.layers.title.gridOrigin"):w(M)("details.layers.title.identifyOrigin")),1)]),content:he(()=>[g("div",Ct,[y.value.length>1?(t(),Z(We,{key:0,results:y.value,detailsProperties:i.value,selected:e.value,onSelectionChanged:m},null,8,["results","detailsProperties","selected"])):O("",!0),g("div",{class:"detailsContentSection overflow-y-auto h-full",ref_key:"detailsPanel",ref:H},[C.value?(t(),s("div",{key:1,class:Q(["text-center",{"ml-42":y.value.length>1}])},N(y.value.length>=1?w(M)("details.layers.results.empty"):w(M)("details.layers.results.empty.noLayers")),3)):(t(),Z(jt,{key:0,uid:e.value,results:y.value,onItemSelected:_[0]||(_[0]=()=>oe(()=>H.value?.scrollTo({top:0})))},null,8,["uid","results"]))],512)])]),_:1},8,["panel"])}}}),zt=ne(Dt,[["__scopeId","data-v-e4b92b97"]]);export{zt as default};
